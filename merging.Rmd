---
title: "merging"
author: "Cheryl Logan"
date: "4/12/2018"
output: html_document
---

## Extracting annotations for your gene list of interest

To do this, we will take advantage of the `tidyverse` package in RStudio. You only need to install the package once, but you will need to load the library every time you open up RStudio on your computer. So, first install it using the `install.packages` command, then load the library using the command below:

```{r setup, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse) # after install.packages("tidyverse")
```

The first thing we want to do is make sure the files we want to work with are in .csv format. We have a gene list of interest and an annotation file. If the files are in text (.txt) files convert to .csv using bash like this. If they are already in .csv format, let's skip this and move on.

`sed 's/ \+/,/g' ifile.txt > ofile.csv`

Example:
```{r, eval=FALSE, message = FALSE, warning = FALSE}
sed 's/ \+/,/g' Exp5_CGH_Trinity_annotated.txt > Exp5_CGH_Trinity_annotated.csv
```
 
Let's say we want to extract the annotations for just our differentially expressed genes (DGElist). We can do this in bash, but first we have to sort each file by column 1. Then, we can join by column 1 assuming col 1 contains ContigNames:

```{bash, eval=FALSE, message = FALSE, warning = FALSE}
sort -t , -k 1,1 big_annotation_file.csv > DGElist_sorted.csv
sort -t , -k 1,1 big_annotation_file.csv > big_annotation_file_sorted.csv
join -j1 big_annotation_file_sorted.csv big_annotation_file_sorted.csv > annot_DGE.csv
```
 
Now we have a much smaller file (annot_DGE.csv) containing the annotations for our DGE list only!

Now, let's read in these files to RStudio
```{r read files, eval=FALSE, message = FALSE, warning = FALSE}
annolist <- read_csv(annot_DGE.csv)
genelist <- read_csv(DGElist_sorted.csv)
```

Merge data into a single data frame
```{r merge, eval=FALSE, message = FALSE, warning = FALSE}
merged.data <- merge(genelist, annolist, by="ContigName")
```